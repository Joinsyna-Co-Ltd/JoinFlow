<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JoinFlow - OS Agent æ§åˆ¶ä¸­å¿ƒ</title>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <style>
    :root {
      /* Cyberpunk Theme Colors */
      --bg-deep: #05080f;
      --bg-primary: #0a0e1a;
      --bg-secondary: #0f1628;
      --bg-card: #141c30;
      --bg-elevated: #1a2540;
      
      --accent-cyan: #00f5ff;
      --accent-purple: #a855f7;
      --accent-pink: #f472b6;
      --accent-green: #22c55e;
      --accent-orange: #f97316;
      --accent-red: #ef4444;
      --accent-blue: #3b82f6;
      --accent-yellow: #fbbf24;
      
      --text-primary: #f0f4ff;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;
      
      --border-color: rgba(0, 245, 255, 0.15);
      --border-glow: rgba(0, 245, 255, 0.3);
      
      --glow-cyan: 0 0 20px rgba(0, 245, 255, 0.4);
      --glow-purple: 0 0 20px rgba(168, 85, 247, 0.4);
      --glow-green: 0 0 20px rgba(34, 197, 94, 0.4);
      
      --font-display: 'Orbitron', 'Noto Sans SC', sans-serif;
      --font-body: 'Rajdhani', 'Noto Sans SC', sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      min-height: 100vh;
      overflow-x: hidden;
    }

    body {
      font-family: var(--font-body);
      background: var(--bg-deep);
      color: var(--text-primary);
      line-height: 1.6;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--accent-cyan);
      border-radius: 10px;
    }

    /* Animated Background */
    .bg-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: -1;
    }

    .grid-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(0, 245, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 245, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
      animation: gridMove 20s linear infinite;
    }

    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }

    .glow-orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      animation: orbFloat 15s ease-in-out infinite;
    }

    .orb-1 {
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(0, 245, 255, 0.15), transparent 70%);
      top: -10%;
      right: -5%;
      animation-delay: 0s;
    }

    .orb-2 {
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(168, 85, 247, 0.12), transparent 70%);
      bottom: 10%;
      left: -5%;
      animation-delay: -5s;
    }

    .orb-3 {
      width: 250px;
      height: 250px;
      background: radial-gradient(circle, rgba(34, 197, 94, 0.1), transparent 70%);
      top: 50%;
      left: 30%;
      animation-delay: -10s;
    }

    @keyframes orbFloat {
      0%, 100% { transform: translate(0, 0) scale(1); }
      25% { transform: translate(30px, -30px) scale(1.1); }
      50% { transform: translate(-20px, 20px) scale(0.95); }
      75% { transform: translate(10px, 40px) scale(1.05); }
    }

    /* Page Container */
    .os-page {
      min-height: 100vh;
      padding: 30px 20px 60px;
      position: relative;
    }

    .os-container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Back Button */
    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      color: var(--text-secondary);
      text-decoration: none;
      padding: 12px 20px;
      border-radius: 12px;
      background: rgba(0, 245, 255, 0.05);
      border: 1px solid rgba(0, 245, 255, 0.1);
      font-family: var(--font-display);
      font-size: 0.85rem;
      letter-spacing: 1px;
      text-transform: uppercase;
      transition: all 0.3s ease;
      margin-bottom: 30px;
    }

    .back-link:hover {
      background: rgba(0, 245, 255, 0.1);
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
      box-shadow: var(--glow-cyan);
      transform: translateX(-5px);
    }

    /* Header Section */
    .os-header {
      text-align: center;
      margin-bottom: 50px;
      position: relative;
    }

    .header-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 20px;
      background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(0, 245, 255, 0.2));
      border: 1px solid rgba(168, 85, 247, 0.3);
      border-radius: 30px;
      font-size: 0.8rem;
      font-family: var(--font-display);
      color: var(--accent-purple);
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 20px;
    }

    .header-badge i {
      color: var(--accent-cyan);
    }

    .os-title {
      font-family: var(--font-display);
      font-size: 3.5rem;
      font-weight: 800;
      letter-spacing: 4px;
      text-transform: uppercase;
      margin-bottom: 15px;
      background: linear-gradient(135deg, #00f5ff 0%, #a855f7 50%, #f472b6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 60px rgba(0, 245, 255, 0.3);
    }

    .os-subtitle {
      font-size: 1.2rem;
      color: var(--text-secondary);
      font-weight: 500;
      letter-spacing: 1px;
    }

    /* Status Card */
    .status-card {
      background: linear-gradient(135deg, var(--bg-card), var(--bg-secondary));
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 35px;
      margin-bottom: 40px;
      position: relative;
      overflow: hidden;
    }

    .status-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--accent-cyan), var(--accent-purple), transparent);
    }

    .status-card.authorized::before {
      background: linear-gradient(90deg, transparent, var(--accent-green), var(--accent-cyan), transparent);
    }

    .status-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 30px;
    }

    .status-info {
      display: flex;
      align-items: center;
      gap: 25px;
    }

    .status-icon-container {
      position: relative;
    }

    .status-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
      border: 2px solid rgba(239, 68, 68, 0.4);
      color: var(--accent-red);
      position: relative;
      z-index: 1;
    }

    .status-icon.unlocked {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));
      border-color: rgba(34, 197, 94, 0.4);
      color: var(--accent-green);
    }

    .status-ring {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      border: 1px solid rgba(0, 245, 255, 0.2);
      border-radius: 50%;
      animation: ringPulse 2s ease-out infinite;
    }

    @keyframes ringPulse {
      0% { transform: translate(-50%, -50%) scale(0.8); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; }
    }

    .status-text h2 {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 5px;
      letter-spacing: 2px;
    }

    .status-text p {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .platform-info {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 24px;
      background: var(--bg-elevated);
      border-radius: 16px;
      border: 1px solid var(--border-color);
    }

    .platform-info i {
      font-size: 1.5rem;
      color: var(--accent-cyan);
    }

    .platform-info span {
      font-family: var(--font-display);
      font-size: 1rem;
      letter-spacing: 1px;
    }

    /* Warning Box */
    .warning-box {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(239, 68, 68, 0.02));
      border: 1px solid rgba(239, 68, 68, 0.2);
      border-radius: 16px;
      padding: 20px 25px;
      margin: 25px 0;
    }

    .warning-box h4 {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--accent-red);
      font-family: var(--font-display);
      font-size: 0.9rem;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }

    .warning-box ul {
      list-style: none;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 8px;
    }

    .warning-box li {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    .warning-box li::before {
      content: '';
      width: 6px;
      height: 6px;
      background: var(--accent-red);
      border-radius: 50%;
      flex-shrink: 0;
    }

    /* Action Buttons */
    .auth-buttons {
      display: flex;
      gap: 15px;
      margin-top: 25px;
      flex-wrap: wrap;
    }

    .auth-btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 14px 28px;
      border-radius: 14px;
      font-family: var(--font-display);
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .auth-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }

    .auth-btn:hover::before {
      left: 100%;
    }

    .auth-btn.primary {
      background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
      color: white;
      box-shadow: 0 4px 20px rgba(168, 85, 247, 0.3);
    }

    .auth-btn.primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(168, 85, 247, 0.4);
    }

    .auth-btn.secondary {
      background: var(--bg-elevated);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .auth-btn.secondary:hover {
      border-color: var(--accent-cyan);
      box-shadow: var(--glow-cyan);
    }

    .auth-btn.danger {
      background: linear-gradient(135deg, var(--accent-red), #dc2626);
      color: white;
      box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
    }

    .auth-btn.danger:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(239, 68, 68, 0.4);
    }

    /* Section Title */
    .section-title {
      font-family: var(--font-display);
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 15px;
      color: var(--text-primary);
    }

    .section-title i {
      color: var(--accent-cyan);
      font-size: 1.1rem;
    }

    .section-title::after {
      content: '';
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, var(--border-glow), transparent);
    }

    /* Quick Actions Grid */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      margin-bottom: 50px;
    }

    .quick-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      padding: 25px 15px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .quick-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--btn-color, var(--accent-cyan)), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .quick-btn:hover::before {
      opacity: 1;
    }

    .quick-btn:hover {
      transform: translateY(-5px);
      border-color: var(--btn-color, var(--accent-cyan));
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3), 0 0 20px var(--btn-glow, rgba(0, 245, 255, 0.2));
    }

    .quick-btn i {
      font-size: 1.8rem;
      color: var(--btn-color, var(--accent-cyan));
      transition: transform 0.3s ease;
    }

    .quick-btn:hover i {
      transform: scale(1.1);
    }

    .quick-btn span {
      font-family: var(--font-display);
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--text-secondary);
      transition: color 0.3s ease;
    }

    .quick-btn:hover span {
      color: var(--text-primary);
    }

    .quick-btn.sys-info { --btn-color: var(--accent-cyan); --btn-glow: rgba(0, 245, 255, 0.2); }
    .quick-btn.screenshot { --btn-color: var(--accent-purple); --btn-glow: rgba(168, 85, 247, 0.2); }
    .quick-btn.files { --btn-color: var(--accent-orange); --btn-glow: rgba(249, 115, 22, 0.2); }
    .quick-btn.clipboard { --btn-color: var(--accent-pink); --btn-glow: rgba(244, 114, 182, 0.2); }
    .quick-btn.processes { --btn-color: var(--accent-green); --btn-glow: rgba(34, 197, 94, 0.2); }
    .quick-btn.notify { --btn-color: var(--accent-yellow); --btn-glow: rgba(251, 191, 36, 0.2); }

    /* Capability Cards */
    .capabilities-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
      margin-bottom: 50px;
    }

    .capability-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 25px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .capability-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--card-accent, var(--accent-cyan));
      opacity: 0.6;
      transition: opacity 0.3s ease;
    }

    .capability-card:hover {
      border-color: var(--card-accent, var(--accent-cyan));
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
    }

    .capability-card:hover::before {
      opacity: 1;
    }

    .capability-card.files { --card-accent: var(--accent-cyan); }
    .capability-card.terminal { --card-accent: var(--accent-purple); }
    .capability-card.apps { --card-accent: var(--accent-green); }
    .capability-card.system { --card-accent: var(--accent-red); }
    .capability-card.input { --card-accent: var(--accent-orange); }
    .capability-card.clipboard { --card-accent: var(--accent-pink); }

    .cap-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .cap-icon {
      width: 50px;
      height: 50px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      background: linear-gradient(135deg, var(--card-accent), rgba(0,0,0,0.5));
      color: white;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .cap-title {
      font-family: var(--font-display);
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 1px;
    }

    .cap-desc {
      color: var(--text-secondary);
      font-size: 0.9rem;
      margin-bottom: 18px;
      padding-left: 65px;
    }

    .cap-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      padding-left: 65px;
    }

    .cap-btn {
      padding: 8px 16px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      color: var(--text-secondary);
      font-family: var(--font-body);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .cap-btn:hover {
      background: var(--card-accent);
      border-color: var(--card-accent);
      color: white;
      box-shadow: 0 0 15px var(--card-accent);
    }

    /* Terminal Section */
    .terminal-section {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 30px;
      margin-bottom: 50px;
      position: relative;
      overflow: hidden;
    }

    .terminal-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--accent-purple), var(--accent-cyan), transparent);
    }

    .terminal-input-row {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }

    .terminal-input {
      flex: 1;
      padding: 14px 20px;
      background: var(--bg-deep);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      color: var(--accent-cyan);
      font-family: var(--font-mono);
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    .terminal-input:focus {
      outline: none;
      border-color: var(--accent-cyan);
      box-shadow: var(--glow-cyan);
    }

    .terminal-input::placeholder {
      color: var(--text-muted);
    }

    .run-btn {
      padding: 14px 28px;
      background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
      border: none;
      border-radius: 14px;
      color: white;
      font-family: var(--font-display);
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 1px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s ease;
    }

    .run-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(168, 85, 247, 0.4);
    }

    .terminal-output {
      background: var(--bg-deep);
      border-radius: 16px;
      padding: 20px;
      font-family: var(--font-mono);
      font-size: 0.85rem;
      min-height: 200px;
      max-height: 350px;
      overflow-y: auto;
      color: var(--accent-green);
      border: 1px solid var(--border-color);
    }

    .terminal-output .prompt {
      color: var(--accent-cyan);
    }

    .terminal-output .error {
      color: var(--accent-red);
    }

    .terminal-output .success {
      color: var(--accent-green);
    }

    .terminal-output .info {
      color: var(--accent-purple);
    }

    .terminal-output .line {
      margin-bottom: 8px;
      line-height: 1.5;
    }

    /* Logs Section */
    .logs-section {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 30px;
      margin-bottom: 50px;
    }

    .logs-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .clear-btn {
      padding: 10px 20px;
      background: transparent;
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 10px;
      color: var(--accent-red);
      font-family: var(--font-body);
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .clear-btn:hover {
      background: rgba(239, 68, 68, 0.1);
      border-color: var(--accent-red);
    }

    .logs-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .log-item {
      display: flex;
      gap: 20px;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      align-items: flex-start;
    }

    .log-item:last-child {
      border-bottom: none;
    }

    .log-time {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--text-muted);
      white-space: nowrap;
    }

    .log-action {
      font-family: var(--font-display);
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--accent-cyan);
      min-width: 80px;
    }

    .log-action.error {
      color: var(--accent-red);
    }

    .log-message {
      color: var(--text-secondary);
      font-size: 0.9rem;
      flex: 1;
    }

    /* File Browser Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(5, 8, 15, 0.9);
      backdrop-filter: blur(10px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 24px;
      width: 90%;
      max-width: 900px;
      max-height: 80vh;
      overflow: hidden;
      position: relative;
    }

    .modal-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent-cyan), var(--accent-purple), var(--accent-pink));
    }

    .modal-header {
      padding: 25px 30px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h3 {
      font-family: var(--font-display);
      font-size: 1.2rem;
      font-weight: 700;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .modal-header h3 i {
      color: var(--accent-orange);
    }

    .modal-close {
      width: 40px;
      height: 40px;
      background: transparent;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      color: var(--text-secondary);
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: rgba(239, 68, 68, 0.1);
      border-color: var(--accent-red);
      color: var(--accent-red);
    }

    .modal-body {
      padding: 25px 30px;
      max-height: calc(80vh - 100px);
      overflow-y: auto;
    }

    .file-path-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      padding: 12px 16px;
      background: var(--bg-deep);
      border-radius: 12px;
      border: 1px solid var(--border-color);
    }

    .file-path-bar i {
      color: var(--accent-orange);
    }

    .file-path-bar input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-family: var(--font-mono);
      font-size: 0.9rem;
    }

    .file-path-bar input:focus {
      outline: none;
    }

    .path-btn {
      padding: 8px 16px;
      background: var(--bg-elevated);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: var(--text-secondary);
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .path-btn:hover {
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
    }

    .file-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .file-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 12px 16px;
      background: var(--bg-elevated);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid transparent;
    }

    .file-item:hover {
      background: rgba(0, 245, 255, 0.05);
      border-color: var(--border-color);
    }

    .file-item i {
      font-size: 1.2rem;
      width: 30px;
      text-align: center;
    }

    .file-item.folder i {
      color: var(--accent-orange);
    }

    .file-item.file i {
      color: var(--text-muted);
    }

    .file-item .name {
      flex: 1;
      font-size: 0.95rem;
    }

    .file-item .size {
      font-family: var(--font-mono);
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* Footer */
    .os-footer {
      text-align: center;
      padding: 30px 20px;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .os-footer a {
      color: var(--accent-cyan);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .os-footer a:hover {
      color: var(--accent-purple);
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 25px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    /* ==================== ç²¾ç¾å¼¹çª—ç³»ç»Ÿ ==================== */
    
    /* å¼¹çª—é®ç½©å±‚ */
    .neon-modal-backdrop {
      position: fixed;
      inset: 0;
      background: radial-gradient(ellipse at center, rgba(10, 14, 26, 0.95) 0%, rgba(5, 8, 15, 0.98) 100%);
      backdrop-filter: blur(12px);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .neon-modal-backdrop.active {
      opacity: 1;
      visibility: visible;
    }

    /* å¼¹çª—ä¸»ä½“ */
    .neon-modal {
      position: relative;
      width: 90%;
      max-width: 480px;
      background: linear-gradient(165deg, rgba(20, 28, 48, 0.98) 0%, rgba(15, 22, 40, 0.98) 100%);
      border-radius: 24px;
      overflow: hidden;
      transform: scale(0.85) translateY(30px);
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      box-shadow: 
        0 0 0 1px rgba(0, 245, 255, 0.1),
        0 0 60px rgba(0, 245, 255, 0.1),
        0 25px 80px rgba(0, 0, 0, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }

    .neon-modal-backdrop.active .neon-modal {
      transform: scale(1) translateY(0);
    }

    /* é¡¶éƒ¨éœ“è™¹ç¯æ¡ */
    .neon-modal::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, 
        transparent 0%,
        var(--modal-accent, var(--accent-cyan)) 20%,
        var(--accent-purple) 50%,
        var(--modal-accent, var(--accent-cyan)) 80%,
        transparent 100%);
      animation: neonPulse 2s ease-in-out infinite;
    }

    @keyframes neonPulse {
      0%, 100% { opacity: 0.8; filter: brightness(1); }
      50% { opacity: 1; filter: brightness(1.3); }
    }

    /* æ‰«æçº¿æ•ˆæœ */
    .neon-modal::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 245, 255, 0.01) 2px,
        rgba(0, 245, 255, 0.01) 4px
      );
      pointer-events: none;
      z-index: 1;
    }

    /* å¼¹çª—å¤´éƒ¨ */
    .neon-modal-header {
      padding: 32px 32px 24px;
      text-align: center;
      position: relative;
      z-index: 2;
    }

    /* å›¾æ ‡å®¹å™¨ */
    .neon-modal-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 20px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .neon-modal-icon::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: linear-gradient(135deg, 
        rgba(var(--icon-rgb, 0, 245, 255), 0.15) 0%,
        rgba(var(--icon-rgb, 0, 245, 255), 0.05) 100%);
      border: 2px solid rgba(var(--icon-rgb, 0, 245, 255), 0.3);
      animation: iconGlow 2s ease-in-out infinite;
    }

    .neon-modal-icon::after {
      content: '';
      position: absolute;
      inset: -10px;
      border-radius: 50%;
      border: 1px solid rgba(var(--icon-rgb, 0, 245, 255), 0.15);
      animation: iconRing 2s ease-out infinite;
    }

    @keyframes iconGlow {
      0%, 100% { box-shadow: 0 0 20px rgba(var(--icon-rgb, 0, 245, 255), 0.2); }
      50% { box-shadow: 0 0 40px rgba(var(--icon-rgb, 0, 245, 255), 0.4); }
    }

    @keyframes iconRing {
      0% { transform: scale(1); opacity: 0.5; }
      100% { transform: scale(1.3); opacity: 0; }
    }

    .neon-modal-icon i {
      font-size: 2rem;
      color: rgb(var(--icon-rgb, 0, 245, 255));
      position: relative;
      z-index: 1;
      filter: drop-shadow(0 0 10px rgba(var(--icon-rgb, 0, 245, 255), 0.5));
    }

    /* å›¾æ ‡ç±»å‹å˜ä½“ */
    .neon-modal-icon.info { --icon-rgb: 0, 245, 255; }
    .neon-modal-icon.success { --icon-rgb: 34, 197, 94; }
    .neon-modal-icon.warning { --icon-rgb: 251, 191, 36; }
    .neon-modal-icon.error { --icon-rgb: 239, 68, 68; }
    .neon-modal-icon.confirm { --icon-rgb: 168, 85, 247; }
    .neon-modal-icon.input { --icon-rgb: 244, 114, 182; }

    /* å¼¹çª—æ ‡é¢˜ */
    .neon-modal-title {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 3px;
      text-transform: uppercase;
      margin-bottom: 8px;
      background: linear-gradient(135deg, var(--text-primary) 0%, rgba(var(--icon-rgb, 0, 245, 255), 1) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .neon-modal-subtitle {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      letter-spacing: 4px;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    /* å¼¹çª—å†…å®¹åŒº */
    .neon-modal-body {
      padding: 0 32px 28px;
      position: relative;
      z-index: 2;
    }

    /* å†…å®¹æ¡† */
    .neon-modal-content {
      background: linear-gradient(135deg, rgba(5, 8, 15, 0.8) 0%, rgba(10, 14, 26, 0.8) 100%);
      border: 1px solid rgba(0, 245, 255, 0.1);
      border-radius: 16px;
      padding: 20px;
      font-family: var(--font-mono);
      font-size: 0.9rem;
      line-height: 1.8;
      color: var(--text-secondary);
      max-height: 250px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .neon-modal-content::-webkit-scrollbar {
      width: 4px;
    }

    .neon-modal-content::-webkit-scrollbar-thumb {
      background: var(--accent-purple);
      border-radius: 4px;
    }

    /* è¾“å…¥æ¡†æ ·å¼ */
    .neon-input-wrapper {
      margin-top: 16px;
    }

    .neon-input-label {
      display: block;
      font-family: var(--font-display);
      font-size: 0.8rem;
      letter-spacing: 2px;
      color: var(--text-secondary);
      margin-bottom: 10px;
      text-transform: uppercase;
    }

    .neon-input {
      width: 100%;
      padding: 16px 20px;
      background: linear-gradient(135deg, rgba(5, 8, 15, 0.9) 0%, rgba(10, 14, 26, 0.9) 100%);
      border: 2px solid rgba(0, 245, 255, 0.15);
      border-radius: 14px;
      color: var(--accent-cyan);
      font-family: var(--font-mono);
      font-size: 1rem;
      transition: all 0.3s ease;
      outline: none;
    }

    .neon-input:focus {
      border-color: var(--accent-cyan);
      box-shadow: 
        0 0 0 4px rgba(0, 245, 255, 0.1),
        0 0 30px rgba(0, 245, 255, 0.15),
        inset 0 0 20px rgba(0, 245, 255, 0.03);
    }

    .neon-input::placeholder {
      color: var(--text-muted);
    }

    .neon-textarea {
      width: 100%;
      padding: 16px 20px;
      background: linear-gradient(135deg, rgba(5, 8, 15, 0.9) 0%, rgba(10, 14, 26, 0.9) 100%);
      border: 2px solid rgba(168, 85, 247, 0.15);
      border-radius: 14px;
      color: var(--accent-purple);
      font-family: var(--font-mono);
      font-size: 0.95rem;
      min-height: 120px;
      resize: vertical;
      transition: all 0.3s ease;
      outline: none;
    }

    .neon-textarea:focus {
      border-color: var(--accent-purple);
      box-shadow: 
        0 0 0 4px rgba(168, 85, 247, 0.1),
        0 0 30px rgba(168, 85, 247, 0.15);
    }

    /* å¼¹çª—åº•éƒ¨æŒ‰é’®åŒº */
    .neon-modal-footer {
      padding: 20px 32px 28px;
      display: flex;
      gap: 14px;
      justify-content: center;
      background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
      position: relative;
      z-index: 2;
    }

    /* å¼¹çª—æŒ‰é’® */
    .neon-btn {
      padding: 14px 32px;
      border-radius: 12px;
      font-family: var(--font-display);
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      cursor: pointer;
      border: none;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      min-width: 120px;
    }

    .neon-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s ease;
    }

    .neon-btn:hover::before {
      left: 100%;
    }

    .neon-btn.primary {
      background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 100%);
      color: white;
      box-shadow: 
        0 4px 20px rgba(0, 245, 255, 0.3),
        0 0 40px rgba(0, 245, 255, 0.1);
    }

    .neon-btn.primary:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 8px 30px rgba(0, 245, 255, 0.4),
        0 0 60px rgba(0, 245, 255, 0.2);
    }

    .neon-btn.secondary {
      background: rgba(26, 37, 64, 0.8);
      color: var(--text-secondary);
      border: 1px solid rgba(0, 245, 255, 0.2);
    }

    .neon-btn.secondary:hover {
      background: rgba(26, 37, 64, 1);
      border-color: var(--accent-cyan);
      color: var(--accent-cyan);
      box-shadow: 0 0 20px rgba(0, 245, 255, 0.2);
    }

    .neon-btn.danger {
      background: linear-gradient(135deg, var(--accent-red) 0%, #dc2626 100%);
      color: white;
      box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
    }

    .neon-btn.danger:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 8px 30px rgba(239, 68, 68, 0.4),
        0 0 40px rgba(239, 68, 68, 0.2);
    }

    /* Toast é€šçŸ¥ */
    .neon-toast-container {
      position: fixed;
      top: 24px;
      right: 24px;
      z-index: 10000;
      display: flex;
      flex-direction: column;
      gap: 12px;
      pointer-events: none;
    }

    .neon-toast {
      background: linear-gradient(165deg, rgba(20, 28, 48, 0.98) 0%, rgba(15, 22, 40, 0.98) 100%);
      border: 1px solid rgba(0, 245, 255, 0.2);
      border-radius: 16px;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 14px;
      min-width: 320px;
      max-width: 420px;
      box-shadow: 
        0 0 40px rgba(0, 0, 0, 0.5),
        0 0 20px rgba(var(--toast-rgb, 0, 245, 255), 0.15);
      transform: translateX(120%);
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      pointer-events: auto;
      position: relative;
      overflow: hidden;
    }

    .neon-toast::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: rgb(var(--toast-rgb, 0, 245, 255));
      box-shadow: 0 0 15px rgba(var(--toast-rgb, 0, 245, 255), 0.5);
    }

    .neon-toast.show {
      transform: translateX(0);
    }

    .neon-toast.success { --toast-rgb: 34, 197, 94; }
    .neon-toast.error { --toast-rgb: 239, 68, 68; }
    .neon-toast.warning { --toast-rgb: 251, 191, 36; }
    .neon-toast.info { --toast-rgb: 0, 245, 255; }

    .neon-toast-icon {
      width: 42px;
      height: 42px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(var(--toast-rgb, 0, 245, 255), 0.15);
      color: rgb(var(--toast-rgb, 0, 245, 255));
      font-size: 1.1rem;
      flex-shrink: 0;
    }

    .neon-toast-content {
      flex: 1;
      min-width: 0;
    }

    .neon-toast-title {
      font-family: var(--font-display);
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .neon-toast-message {
      font-size: 0.85rem;
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .neon-toast-close {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      background: transparent;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .neon-toast-close:hover {
      background: rgba(239, 68, 68, 0.15);
      color: var(--accent-red);
    }

    .neon-toast-progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: linear-gradient(90deg, 
        rgb(var(--toast-rgb, 0, 245, 255)),
        rgba(var(--toast-rgb, 0, 245, 255), 0.5));
      border-radius: 0 0 0 16px;
      transition: width linear;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .os-title {
        font-size: 2rem;
      }

      .status-content {
        flex-direction: column;
        text-align: center;
      }

      .status-info {
        flex-direction: column;
      }

      .auth-buttons {
        justify-content: center;
      }

      .capabilities-grid {
        grid-template-columns: 1fr;
      }

      .cap-desc, .cap-actions {
        padding-left: 0;
      }

      .quick-actions {
        grid-template-columns: repeat(3, 1fr);
      }

      .terminal-input-row {
        flex-direction: column;
      }

      .neon-modal {
        max-width: 95%;
        border-radius: 20px;
      }

      .neon-modal-header {
        padding: 28px 24px 20px;
      }

      .neon-modal-body {
        padding: 0 24px 24px;
      }

      .neon-modal-footer {
        padding: 16px 24px 24px;
        flex-direction: column;
      }

      .neon-btn {
        width: 100%;
      }

      .neon-toast-container {
        top: 16px;
        right: 16px;
        left: 16px;
      }

      .neon-toast {
        min-width: auto;
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <!-- Animated Background -->
  <div class="bg-container">
    <div class="grid-overlay"></div>
    <div class="glow-orb orb-1"></div>
    <div class="glow-orb orb-2"></div>
    <div class="glow-orb orb-3"></div>
  </div>

  <div class="os-page">
    <div class="os-container">
      <!-- Back Link -->
      <a href="/" class="back-link">
        <i class="fas fa-arrow-left"></i>
        <span>è¿”å›ä¸»é¡µ</span>
      </a>

      <!-- Header -->
      <div class="os-header">
        <div class="header-badge">
          <i class="fas fa-microchip"></i>
          <span>Agent OS</span>
        </div>
        <h1 class="os-title">ç³»ç»Ÿæ§åˆ¶ä¸­å¿ƒ</h1>
        <p class="os-subtitle">è®© AI ç›´æ¥æ“æ§æ‚¨çš„æ“ä½œç³»ç»Ÿ Â· é‡Šæ”¾æ— é™å¯èƒ½</p>
      </div>

      <!-- Status Card -->
      <div class="status-card" id="authCard">
        <div class="status-content">
          <div class="status-info">
            <div class="status-icon-container">
              <div class="status-icon" id="statusIcon">
                <i class="fas fa-lock"></i>
              </div>
              <div class="status-ring"></div>
            </div>
            <div class="status-text">
              <h2 id="statusTitle">æœªæˆæƒ</h2>
              <p id="statusDesc">æˆæƒå AI å¯ä»¥æ“æ§æ‚¨çš„ç³»ç»Ÿ</p>
            </div>
          </div>
          <div class="platform-info" id="platformBadge">
            <i class="fab fa-windows"></i>
            <span>æ£€æµ‹ä¸­...</span>
          </div>
        </div>

        <div class="warning-box" id="authWarnings">
          <h4><i class="fas fa-exclamation-triangle"></i> å®‰å…¨æé†’</h4>
          <ul>
            <li>å®Œæ•´æˆæƒå…è®¸ AI è¯»å†™ç³»ç»Ÿæ–‡ä»¶</li>
            <li>å¯æ‰§è¡Œä»»æ„ Shell å‘½ä»¤</li>
            <li>å¯å¯åŠ¨å’Œå…³é—­åº”ç”¨ç¨‹åº</li>
            <li>å¯æ§åˆ¶é¼ æ ‡å’Œé”®ç›˜</li>
            <li>ä»…åœ¨å—ä¿¡ä»»ç¯å¢ƒä¸‹ä½¿ç”¨</li>
          </ul>
        </div>

        <div class="auth-buttons">
          <button class="auth-btn primary" id="authorizeBtn" onclick="requestAuthorization()">
            <i class="fas fa-shield-alt"></i>
            æˆæƒå®Œæ•´æ§åˆ¶
          </button>
          <button class="auth-btn secondary" onclick="requestAuthorization('workspace')">
            <i class="fas fa-folder"></i>
            ä»…å·¥ä½œåŒºæƒé™
          </button>
          <button class="auth-btn danger" id="revokeBtn" style="display: none;" onclick="revokeAuthorization()">
            <i class="fas fa-ban"></i>
            æ’¤é”€æˆæƒ
          </button>
        </div>
      </div>

      <!-- Quick Actions -->
      <h3 class="section-title"><i class="fas fa-bolt"></i> å¿«æ·æ“ä½œ</h3>
      <div class="quick-actions">
        <button class="quick-btn sys-info" onclick="getSystemInfo()">
          <i class="fas fa-server"></i>
          <span>ç³»ç»Ÿä¿¡æ¯</span>
        </button>
        <button class="quick-btn screenshot" onclick="takeScreenshot()">
          <i class="fas fa-camera"></i>
          <span>æˆªå±</span>
        </button>
        <button class="quick-btn files" onclick="openFileBrowser()">
          <i class="fas fa-folder-open"></i>
          <span>æ–‡ä»¶æµè§ˆ</span>
        </button>
        <button class="quick-btn clipboard" onclick="getClipboard()">
          <i class="fas fa-clipboard"></i>
          <span>å‰ªè´´æ¿</span>
        </button>
        <button class="quick-btn processes" onclick="listProcesses()">
          <i class="fas fa-tasks"></i>
          <span>è¿›ç¨‹åˆ—è¡¨</span>
        </button>
        <button class="quick-btn notify" onclick="showNotification()">
          <i class="fas fa-bell"></i>
          <span>å‘é€é€šçŸ¥</span>
        </button>
      </div>

      <!-- Capabilities -->
      <h3 class="section-title"><i class="fas fa-puzzle-piece"></i> åŠŸèƒ½æ¨¡å—</h3>
      <div class="capabilities-grid">
        <!-- Files -->
        <div class="capability-card files">
          <div class="cap-header">
            <div class="cap-icon">
              <i class="fas fa-folder"></i>
            </div>
            <h4 class="cap-title">æ–‡ä»¶ç³»ç»Ÿ</h4>
          </div>
          <p class="cap-desc">è¯»å†™æ–‡ä»¶ã€åˆ›å»ºç›®å½•ã€å¤åˆ¶ç§»åŠ¨ç­‰æ“ä½œ</p>
          <div class="cap-actions">
            <button class="cap-btn" onclick="openFileBrowser()">æµè§ˆ</button>
            <button class="cap-btn" onclick="promptReadFile()">è¯»å–</button>
            <button class="cap-btn" onclick="promptWriteFile()">å†™å…¥</button>
          </div>
        </div>

        <!-- Terminal -->
        <div class="capability-card terminal">
          <div class="cap-header">
            <div class="cap-icon">
              <i class="fas fa-terminal"></i>
            </div>
            <h4 class="cap-title">å‘½ä»¤æ‰§è¡Œ</h4>
          </div>
          <p class="cap-desc">æ‰§è¡Œ Shell / PowerShell / Bash å‘½ä»¤</p>
          <div class="cap-actions">
            <button class="cap-btn" onclick="focusTerminal()">æ‰“å¼€ç»ˆç«¯</button>
          </div>
        </div>

        <!-- Apps -->
        <div class="capability-card apps">
          <div class="cap-header">
            <div class="cap-icon">
              <i class="fas fa-window-restore"></i>
            </div>
            <h4 class="cap-title">åº”ç”¨ç®¡ç†</h4>
          </div>
          <p class="cap-desc">å¯åŠ¨åº”ç”¨ã€æ‰“å¼€æ–‡ä»¶ã€æ‰“å¼€ URL</p>
          <div class="cap-actions">
            <button class="cap-btn" onclick="promptOpenApp()">æ‰“å¼€åº”ç”¨</button>
            <button class="cap-btn" onclick="promptOpenUrl()">æ‰“å¼€ URL</button>
          </div>
        </div>

        <!-- System -->
        <div class="capability-card system">
          <div class="cap-header">
            <div class="cap-icon">
              <i class="fas fa-server"></i>
            </div>
            <h4 class="cap-title">ç³»ç»Ÿæ§åˆ¶</h4>
          </div>
          <p class="cap-desc">ç³»ç»Ÿä¿¡æ¯ã€æˆªå±ã€é€šçŸ¥ç­‰åŠŸèƒ½</p>
          <div class="cap-actions">
            <button class="cap-btn" onclick="getSystemInfo()">ç³»ç»Ÿä¿¡æ¯</button>
            <button class="cap-btn" onclick="takeScreenshot()">æˆªå±</button>
          </div>
        </div>

        <!-- Input -->
        <div class="capability-card input">
          <div class="cap-header">
            <div class="cap-icon">
              <i class="fas fa-keyboard"></i>
            </div>
            <h4 class="cap-title">è¾“å…¥æ§åˆ¶</h4>
          </div>
          <p class="cap-desc">æ¨¡æ‹Ÿé”®ç›˜è¾“å…¥ã€é¼ æ ‡æ“ä½œ</p>
          <div class="cap-actions">
            <button class="cap-btn" onclick="promptTypeText()">è¾“å…¥æ–‡å­—</button>
            <button class="cap-btn" onclick="promptHotkey()">ç»„åˆé”®</button>
          </div>
        </div>

        <!-- Clipboard -->
        <div class="capability-card clipboard">
          <div class="cap-header">
            <div class="cap-icon">
              <i class="fas fa-paste"></i>
            </div>
            <h4 class="cap-title">å‰ªè´´æ¿</h4>
          </div>
          <p class="cap-desc">è·å–å’Œè®¾ç½®å‰ªè´´æ¿å†…å®¹</p>
          <div class="cap-actions">
            <button class="cap-btn" onclick="getClipboard()">è·å–</button>
            <button class="cap-btn" onclick="promptSetClipboard()">è®¾ç½®</button>
          </div>
        </div>
      </div>

      <!-- Terminal Section -->
      <h3 class="section-title"><i class="fas fa-terminal"></i> æ™ºèƒ½å‘½ä»¤ç»ˆç«¯</h3>
      <div class="terminal-section">
        <div class="terminal-input-row">
          <input type="text" class="terminal-input" id="cmdInput" placeholder="ç”¨è‡ªç„¶è¯­è¨€æè¿°ä½ æƒ³åšä»€ä¹ˆï¼Œä¾‹å¦‚ï¼šæ‰“å¼€cmdæ‰§è¡Œipconfig" onkeypress="handleCmdKeypress(event)">
          <button id="modelSelectBtn" class="mode-btn" onclick="showModelSelector()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); margin-right: 8px; padding: 10px 15px; border-radius: 8px; border: none; color: white; cursor: pointer; font-size: 12px;" title="é€‰æ‹© AI æ¨¡å‹">
            <i class="fas fa-robot"></i> <span id="currentModelName">è‡ªåŠ¨</span>
          </button>
          <button id="smartModeBtn" class="mode-btn" onclick="toggleSmartMode()" style="background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%); margin-right: 8px; padding: 10px 15px; border-radius: 8px; border: none; color: white; cursor: pointer; font-size: 12px;">
            <i class="fas fa-brain"></i> æ™ºèƒ½æ¨¡å¼
          </button>
          <button class="run-btn" onclick="runCommand()">
            <i class="fas fa-play"></i>
            æ‰§è¡Œ
          </button>
        </div>
        <div class="terminal-output" id="terminalOutput">
          <div class="line info"><span class="prompt">Î»</span> JoinFlow OS Agent æ™ºèƒ½ç»ˆç«¯å°±ç»ª</div>
          <div class="line info"><span class="prompt">Î»</span> ğŸ¤– æ™ºèƒ½æ¨¡å¼å·²å¯ç”¨ - ç”¨è‡ªç„¶è¯­è¨€æè¿°ä½ æƒ³åšä»€ä¹ˆ</div>
          <div class="line info"><span class="prompt">Î»</span> ä¾‹å¦‚ï¼šæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ã€æ‰“å¼€è®°äº‹æœ¬ã€æ˜¾ç¤ºç½‘ç»œé…ç½®...</div>
        </div>
      </div>

      <!-- Logs Section -->
      <h3 class="section-title"><i class="fas fa-history"></i> æ“ä½œæ—¥å¿—</h3>
      <div class="logs-section">
        <div class="logs-header">
          <span style="color: var(--text-secondary);">è®°å½•æ‰€æœ‰ç³»ç»Ÿæ“ä½œ</span>
          <button class="clear-btn" onclick="clearLogs()">
            <i class="fas fa-trash-alt"></i> æ¸…é™¤æ—¥å¿—
          </button>
        </div>
        <div class="logs-list" id="logsList">
          <div class="log-item">
            <span class="log-time">--:--:--</span>
            <span class="log-action">ç³»ç»Ÿ</span>
            <span class="log-message">ç­‰å¾…æ“ä½œ...</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="os-footer">
        <div class="footer-links">
          <a href="/">é¦–é¡µ</a>
          <a href="/workspace">å·¥ä½œå°</a>
          <a href="/pricing">è®¢é˜…</a>
          <a href="/terms">æœåŠ¡æ¡æ¬¾</a>
          <a href="/privacy">éšç§æ”¿ç­–</a>
        </div>
        <p>Â© 2024 JoinFlow. All rights reserved.</p>
      </footer>
    </div>
  </div>

  <!-- ç²¾ç¾å¼¹çª— -->
  <div class="neon-modal-backdrop" id="neonModal">
    <div class="neon-modal">
      <div class="neon-modal-header">
        <div class="neon-modal-icon info" id="neonModalIcon">
          <i class="fas fa-info-circle" id="neonModalIconI"></i>
        </div>
        <h2 class="neon-modal-title" id="neonModalTitle">ç³»ç»Ÿæç¤º</h2>
        <p class="neon-modal-subtitle" id="neonModalSubtitle">SYSTEM NOTIFICATION</p>
      </div>
      <div class="neon-modal-body" id="neonModalBody">
        <div class="neon-modal-content" id="neonModalContent"></div>
        <div class="neon-input-wrapper" id="neonInputWrapper" style="display: none;">
          <label class="neon-input-label" id="neonInputLabel">è¯·è¾“å…¥</label>
          <input type="text" class="neon-input" id="neonInput" placeholder="åœ¨æ­¤è¾“å…¥...">
        </div>
        <div class="neon-input-wrapper" id="neonTextareaWrapper" style="display: none;">
          <label class="neon-input-label" id="neonTextareaLabel">è¯·è¾“å…¥å†…å®¹</label>
          <textarea class="neon-textarea" id="neonTextarea" placeholder="åœ¨æ­¤è¾“å…¥å†…å®¹..."></textarea>
        </div>
      </div>
      <div class="neon-modal-footer" id="neonModalFooter">
        <button class="neon-btn secondary" id="neonBtnCancel" onclick="neonModalCancel()">å–æ¶ˆ</button>
        <button class="neon-btn primary" id="neonBtnConfirm" onclick="neonModalConfirm()">ç¡®è®¤</button>
      </div>
    </div>
  </div>

  <!-- Toast é€šçŸ¥å®¹å™¨ -->
  <div class="neon-toast-container" id="neonToastContainer"></div>

  <!-- File Browser Modal -->
  <div class="modal-overlay" id="fileBrowserModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-folder-open"></i> æ–‡ä»¶æµè§ˆå™¨</h3>
        <button class="modal-close" onclick="closeFileBrowser()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="file-path-bar">
          <i class="fas fa-folder"></i>
          <input type="text" id="currentPath" value="." onkeypress="if(event.key==='Enter') navigateToPath()">
          <button class="path-btn" onclick="navigateToPath()">å‰å¾€</button>
          <button class="path-btn" onclick="goUp()">ä¸Šçº§</button>
        </div>
        <div class="file-list" id="fileList">
          <!-- Files will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = '/api/os';
    let isAuthorized = false;
    let currentPlatform = 'Unknown';
    
    // ==================== ç²¾ç¾å¼¹çª—ç³»ç»Ÿ ====================
    let neonModalResolve = null;
    
    const iconConfig = {
      info: { icon: 'fa-info-circle', class: 'info', subtitle: 'INFORMATION' },
      success: { icon: 'fa-check-circle', class: 'success', subtitle: 'SUCCESS' },
      warning: { icon: 'fa-exclamation-triangle', class: 'warning', subtitle: 'WARNING' },
      error: { icon: 'fa-times-circle', class: 'error', subtitle: 'ERROR' },
      confirm: { icon: 'fa-question-circle', class: 'confirm', subtitle: 'CONFIRM ACTION' },
      input: { icon: 'fa-keyboard', class: 'input', subtitle: 'INPUT REQUIRED' }
    };

    // Alert å¼¹çª—
    function neonAlert(message, title = 'ç³»ç»Ÿæç¤º', type = 'info') {
      return new Promise(resolve => {
        neonModalResolve = resolve;
        const config = iconConfig[type] || iconConfig.info;
        
        document.getElementById('neonModalIcon').className = 'neon-modal-icon ' + config.class;
        document.getElementById('neonModalIconI').className = 'fas ' + config.icon;
        document.getElementById('neonModalTitle').textContent = title;
        document.getElementById('neonModalSubtitle').textContent = config.subtitle;
        document.getElementById('neonModalContent').innerHTML = message.replace(/\n/g, '<br>');
        document.getElementById('neonModalContent').style.display = 'block';
        document.getElementById('neonInputWrapper').style.display = 'none';
        document.getElementById('neonTextareaWrapper').style.display = 'none';
        document.getElementById('neonBtnCancel').style.display = 'none';
        document.getElementById('neonBtnConfirm').textContent = 'ç¡®å®š';
        document.getElementById('neonBtnConfirm').className = 'neon-btn primary';
        
        document.getElementById('neonModal').classList.add('active');
        document.getElementById('neonBtnConfirm').focus();
      });
    }

    // Confirm å¼¹çª—
    function neonConfirm(message, title = 'ç¡®è®¤æ“ä½œ') {
      return new Promise(resolve => {
        neonModalResolve = resolve;
        const config = iconConfig.confirm;
        
        document.getElementById('neonModalIcon').className = 'neon-modal-icon ' + config.class;
        document.getElementById('neonModalIconI').className = 'fas ' + config.icon;
        document.getElementById('neonModalTitle').textContent = title;
        document.getElementById('neonModalSubtitle').textContent = config.subtitle;
        document.getElementById('neonModalContent').innerHTML = message.replace(/\n/g, '<br>');
        document.getElementById('neonModalContent').style.display = 'block';
        document.getElementById('neonInputWrapper').style.display = 'none';
        document.getElementById('neonTextareaWrapper').style.display = 'none';
        document.getElementById('neonBtnCancel').style.display = 'inline-flex';
        document.getElementById('neonBtnCancel').textContent = 'å–æ¶ˆ';
        document.getElementById('neonBtnConfirm').textContent = 'ç¡®è®¤';
        document.getElementById('neonBtnConfirm').className = 'neon-btn danger';
        
        document.getElementById('neonModal').classList.add('active');
        document.getElementById('neonBtnConfirm').focus();
      });
    }

    // Prompt å¼¹çª—
    function neonPrompt(label, defaultValue = '', title = 'è¯·è¾“å…¥', options = {}) {
      return new Promise(resolve => {
        neonModalResolve = resolve;
        const config = iconConfig.input;
        
        document.getElementById('neonModalIcon').className = 'neon-modal-icon ' + config.class;
        document.getElementById('neonModalIconI').className = 'fas ' + config.icon;
        document.getElementById('neonModalTitle').textContent = title;
        document.getElementById('neonModalSubtitle').textContent = config.subtitle;
        document.getElementById('neonModalContent').style.display = 'none';
        
        if (options.multiline) {
          document.getElementById('neonInputWrapper').style.display = 'none';
          document.getElementById('neonTextareaWrapper').style.display = 'block';
          document.getElementById('neonTextareaLabel').textContent = label;
          document.getElementById('neonTextarea').value = defaultValue;
          document.getElementById('neonTextarea').placeholder = options.placeholder || 'åœ¨æ­¤è¾“å…¥å†…å®¹...';
          setTimeout(() => document.getElementById('neonTextarea').focus(), 100);
        } else {
          document.getElementById('neonTextareaWrapper').style.display = 'none';
          document.getElementById('neonInputWrapper').style.display = 'block';
          document.getElementById('neonInputLabel').textContent = label;
          document.getElementById('neonInput').value = defaultValue;
          document.getElementById('neonInput').placeholder = options.placeholder || 'åœ¨æ­¤è¾“å…¥...';
          setTimeout(() => document.getElementById('neonInput').focus(), 100);
        }
        
        document.getElementById('neonBtnCancel').style.display = 'inline-flex';
        document.getElementById('neonBtnCancel').textContent = 'å–æ¶ˆ';
        document.getElementById('neonBtnConfirm').textContent = 'ç¡®å®š';
        document.getElementById('neonBtnConfirm').className = 'neon-btn primary';
        
        document.getElementById('neonModal').classList.add('active');
      });
    }

    function neonModalConfirm() {
      document.getElementById('neonModal').classList.remove('active');
      if (neonModalResolve) {
        const inputWrapper = document.getElementById('neonInputWrapper');
        const textareaWrapper = document.getElementById('neonTextareaWrapper');
        
        if (inputWrapper.style.display !== 'none') {
          neonModalResolve(document.getElementById('neonInput').value);
        } else if (textareaWrapper.style.display !== 'none') {
          neonModalResolve(document.getElementById('neonTextarea').value);
        } else {
          neonModalResolve(true);
        }
        neonModalResolve = null;
      }
    }

    function neonModalCancel() {
      document.getElementById('neonModal').classList.remove('active');
      if (neonModalResolve) {
        const inputWrapper = document.getElementById('neonInputWrapper');
        const textareaWrapper = document.getElementById('neonTextareaWrapper');
        
        if (inputWrapper.style.display !== 'none' || textareaWrapper.style.display !== 'none') {
          neonModalResolve(null);
        } else {
          neonModalResolve(false);
        }
        neonModalResolve = null;
      }
    }

    // Toast é€šçŸ¥
    function neonToast(message, title = 'é€šçŸ¥', type = 'info', duration = 4000) {
      const container = document.getElementById('neonToastContainer');
      const icons = {
        success: 'fa-check-circle',
        error: 'fa-times-circle',
        warning: 'fa-exclamation-triangle',
        info: 'fa-info-circle'
      };
      
      const toast = document.createElement('div');
      toast.className = `neon-toast ${type}`;
      toast.innerHTML = `
        <div class="neon-toast-icon"><i class="fas ${icons[type] || icons.info}"></i></div>
        <div class="neon-toast-content">
          <div class="neon-toast-title">${title}</div>
          <div class="neon-toast-message">${message}</div>
        </div>
        <button class="neon-toast-close" onclick="this.parentElement.remove()">
          <i class="fas fa-times"></i>
        </button>
        <div class="neon-toast-progress" style="width: 100%"></div>
      `;
      
      container.appendChild(toast);
      setTimeout(() => toast.classList.add('show'), 10);
      
      const progress = toast.querySelector('.neon-toast-progress');
      progress.style.transition = `width ${duration}ms linear`;
      setTimeout(() => progress.style.width = '0%', 50);
      
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 400);
      }, duration);
    }

    // å¼¹çª—äº‹ä»¶ç›‘å¬
    document.addEventListener('DOMContentLoaded', () => {
      // ç‚¹å‡»é®ç½©å…³é—­
      document.getElementById('neonModal').addEventListener('click', e => {
        if (e.target.classList.contains('neon-modal-backdrop')) neonModalCancel();
      });
      
      // è¾“å…¥æ¡†å›è½¦ç¡®è®¤ï¼ŒEscapeå–æ¶ˆ
      document.getElementById('neonInput').addEventListener('keydown', e => {
        if (e.key === 'Enter') neonModalConfirm();
        if (e.key === 'Escape') neonModalCancel();
      });
      
      document.getElementById('neonTextarea').addEventListener('keydown', e => {
        if (e.key === 'Escape') neonModalCancel();
      });
      
      // Escape é”®å…³é—­å¼¹çª—
      document.addEventListener('keydown', e => {
        if (e.key === 'Escape' && document.getElementById('neonModal').classList.contains('active')) {
          neonModalCancel();
        }
      });
      
      checkStatus();
    });
    // ==================== å¼¹çª—ç³»ç»Ÿç»“æŸ ====================
    
    // Check authorization status
    async function checkStatus() {
      try {
        const response = await fetch(`${API_BASE}/status`);
        const data = await response.json();
        
        isAuthorized = data.authorized;
        currentPlatform = data.platform;
        
        updateUI(data);
        addLog('ç³»ç»Ÿ', `çŠ¶æ€æ£€æŸ¥å®Œæˆ - å¹³å°: ${data.platform}`);
      } catch (error) {
        addLog('é”™è¯¯', `çŠ¶æ€æ£€æŸ¥å¤±è´¥: ${error.message}`, true);
      }
    }
    
    // Update UI based on status
    function updateUI(data) {
      const authCard = document.getElementById('authCard');
      const statusIcon = document.getElementById('statusIcon');
      const statusTitle = document.getElementById('statusTitle');
      const statusDesc = document.getElementById('statusDesc');
      const authorizeBtn = document.getElementById('authorizeBtn');
      const revokeBtn = document.getElementById('revokeBtn');
      const platformBadge = document.getElementById('platformBadge');
      const authWarnings = document.getElementById('authWarnings');
      
      // Platform badge
      const platformIcons = {
        'Windows': 'fab fa-windows',
        'Darwin': 'fab fa-apple',
        'Linux': 'fab fa-linux'
      };
      platformBadge.innerHTML = `
        <i class="${platformIcons[data.platform] || 'fas fa-desktop'}"></i>
        <span>${data.platform}</span>
      `;
      
      if (data.authorized) {
        authCard.classList.add('authorized');
        statusIcon.classList.add('unlocked');
        statusIcon.innerHTML = '<i class="fas fa-unlock"></i>';
        statusTitle.textContent = 'å·²æˆæƒ';
        statusDesc.textContent = 'å®Œæ•´ç³»ç»Ÿæ§åˆ¶æƒé™å·²å¯ç”¨';
        authorizeBtn.style.display = 'none';
        revokeBtn.style.display = 'flex';
        authWarnings.style.display = 'none';
      } else {
        authCard.classList.remove('authorized');
        statusIcon.classList.remove('unlocked');
        statusIcon.innerHTML = '<i class="fas fa-lock"></i>';
        statusTitle.textContent = 'æœªæˆæƒ';
        statusDesc.textContent = 'æˆæƒå AI å¯ä»¥æ“æ§æ‚¨çš„ç³»ç»Ÿ';
        authorizeBtn.style.display = 'flex';
        revokeBtn.style.display = 'none';
        authWarnings.style.display = 'block';
      }
    }
    
    // Request authorization
    async function requestAuthorization(scope = 'full') {
      try {
        const response = await fetch(`${API_BASE}/authorize`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ scope: scope, confirm: false })
        });
        const data = await response.json();
        
        if (data.authorization_request) {
          const warnings = data.warnings.join('\nâ€¢ ');
          const confirmed = await neonConfirm(`${data.message}\n\nâ€¢ ${warnings}`, 'æˆæƒç¡®è®¤');
          
          if (confirmed) {
            const confirmResponse = await fetch(`${API_BASE}/authorize`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ scope: scope, confirm: true })
            });
            const confirmData = await confirmResponse.json();
            
            if (confirmData.success) {
              addLog('æˆæƒ', `æˆæƒæˆåŠŸ - èŒƒå›´: ${scope}`);
              neonToast('ç³»ç»Ÿæ§åˆ¶æƒé™å·²å¯ç”¨', 'æˆæƒæˆåŠŸ', 'success');
              checkStatus();
            } else {
              addLog('é”™è¯¯', confirmData.message, true);
              await neonAlert(confirmData.message, 'æˆæƒå¤±è´¥', 'error');
            }
          }
        }
      } catch (error) {
        addLog('é”™è¯¯', `æˆæƒè¯·æ±‚å¤±è´¥: ${error.message}`, true);
        await neonAlert(`æˆæƒè¯·æ±‚å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // Revoke authorization
    async function revokeAuthorization() {
      const confirmed = await neonConfirm('ç¡®å®šè¦æ’¤é”€ç³»ç»Ÿæ§åˆ¶æˆæƒå—ï¼Ÿ\n\næ’¤é”€å AI å°†æ— æ³•æ§åˆ¶æ‚¨çš„ç³»ç»Ÿã€‚', 'æ’¤é”€æˆæƒ');
      if (!confirmed) return;
      
      try {
        const response = await fetch(`${API_BASE}/revoke`, { method: 'POST' });
        const data = await response.json();
        
        if (data.success) {
          addLog('æˆæƒ', 'æˆæƒå·²æ’¤é”€');
          neonToast('ç³»ç»Ÿæ§åˆ¶æƒé™å·²ç¦ç”¨', 'æˆæƒå·²æ’¤é”€', 'warning');
          checkStatus();
        }
      } catch (error) {
        addLog('é”™è¯¯', `æ’¤é”€å¤±è´¥: ${error.message}`, true);
        await neonAlert(`æ’¤é”€å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // æ™ºèƒ½æ¨¡å¼å¼€å…³
    let smartMode = true;
    
    // Run shell command (æ™ºèƒ½æ¨¡å¼ - ä½¿ç”¨å¤§æ¨¡å‹ç†è§£æ„å›¾)
    async function runCommand() {
      const input = document.getElementById('cmdInput');
      const query = input.value.trim();
      if (!query) return;
      
      // æ£€æŸ¥æˆæƒçŠ¶æ€
      if (!isAuthorized) {
        appendTerminal(`$ ${query}`, 'prompt');
        appendTerminal('âŒ é”™è¯¯: æœªæˆæƒ - è¯·å…ˆç‚¹å‡»ä¸Šæ–¹çš„"æˆæƒå®Œæ•´æ§åˆ¶"æŒ‰é’®è¿›è¡Œæˆæƒ', 'error');
        addLog('é”™è¯¯', 'æœªæˆæƒï¼šè¯·å…ˆæˆæƒåæ‰èƒ½æ‰§è¡Œå‘½ä»¤', true);
        await neonAlert('è¯·å…ˆç‚¹å‡»ä¸Šæ–¹çš„"æˆæƒå®Œæ•´æ§åˆ¶"æˆ–"ä»…å·¥ä½œåŒºæƒé™"æŒ‰é’®è¿›è¡Œæˆæƒï¼Œæˆæƒåæ‰èƒ½ä½¿ç”¨æ™ºèƒ½å‘½ä»¤ç»ˆç«¯ã€‚', 'éœ€è¦æˆæƒ', 'warning');
        return;
      }
      
      appendTerminal(`$ ${query}`, 'prompt');
      input.value = '';
      
      if (smartMode) {
        // æ™ºèƒ½æ¨¡å¼ï¼šä½¿ç”¨å¤§æ¨¡å‹ç†è§£æ„å›¾
        appendTerminal('ğŸ¤– ç†è§£æ„å›¾ä¸­...', 'info');
        
        try {
          const response = await fetch(`${API_BASE}/command/smart`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query: query })
          });
          
          // æ£€æŸ¥æ˜¯å¦æ˜¯æˆæƒé”™è¯¯
          if (response.status === 403) {
            appendTerminal('âŒ é”™è¯¯: æˆæƒå·²è¿‡æœŸæˆ–è¢«æ’¤é”€ï¼Œè¯·é‡æ–°æˆæƒ', 'error');
            addLog('é”™è¯¯', 'æˆæƒå·²è¿‡æœŸï¼Œè¯·é‡æ–°æˆæƒ', true);
            isAuthorized = false;
            checkStatus();
            return;
          }
          
          const data = await response.json();
          
          if (data.data) {
            // æ˜¾ç¤ºæ„å›¾ç†è§£ç»“æœ
            if (data.data.intent) {
              appendTerminal(`ğŸ“Œ æ„å›¾: ${data.data.intent}`, 'info');
            }
            
            // ä¼˜å…ˆæ˜¾ç¤ºå¤§æ¨¡å‹æ±‡æ€»ç»“æœ
            if (data.data.summary) {
              appendTerminal('', 'info');
              appendSummaryBox(data.data.summary);
              addLog('æ™ºèƒ½å‘½ä»¤', `${data.data.intent} (å·²æ±‡æ€»)`);
              
              // æ·»åŠ å¯é€‰çš„è¯¦ç»†è¾“å‡ºå±•å¼€
              if (data.data.results && data.data.results.length > 0) {
                appendTerminal('', 'info');
                appendCollapsibleDetails(data.data.results);
              }
            } 
            // å¦‚æœæ²¡æœ‰æ±‡æ€»ï¼Œåˆ™æ˜¾ç¤ºåŸå§‹å‘½ä»¤è¾“å‡º
            else if (data.data.results && data.data.results.length > 0) {
              if (data.data.explanation) {
                appendTerminal(`ğŸ’¡ è¯´æ˜: ${data.data.explanation}`, 'info');
              }
              for (const result of data.data.results) {
                appendTerminal(`\nâ–¶ æ‰§è¡Œ: ${result.command}`, 'prompt');
                if (result.output) {
                  appendTerminal(result.output, result.success ? '' : 'error');
                }
              }
              addLog('æ™ºèƒ½å‘½ä»¤', `${data.data.intent} (${data.data.commands.length}æ¡å‘½ä»¤)`);
            } else {
              appendTerminal(data.message || 'æ²¡æœ‰éœ€è¦æ‰§è¡Œçš„å‘½ä»¤', 'info');
            }
          } else if (data.message) {
            appendTerminal(data.message, data.success ? 'info' : 'error');
          }
        } catch (error) {
          appendTerminal(`é”™è¯¯: ${error.message}`, 'error');
          // é™çº§åˆ°ç›´æ¥æ‰§è¡Œ
          appendTerminal('âš ï¸ æ™ºèƒ½æ¨¡å¼å¤±è´¥ï¼Œå°è¯•ç›´æ¥æ‰§è¡Œ...', 'info');
          await runDirectCommand(query);
        }
      } else {
        // ç›´æ¥æ‰§è¡Œæ¨¡å¼
        await runDirectCommand(query);
      }
    }
    
    // ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼ˆä¸ç»è¿‡å¤§æ¨¡å‹ï¼‰
    async function runDirectCommand(command) {
      try {
        const response = await fetch(`${API_BASE}/command/run`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ command: command })
        });
        const data = await response.json();
        
        if (data.data) {
          if (data.data.stdout) {
            appendTerminal(data.data.stdout);
          }
          if (data.data.stderr) {
            appendTerminal(data.data.stderr, 'error');
          }
          if (!data.data.stdout && !data.data.stderr) {
            if (data.success) {
              appendTerminal(`âœ“ ${data.message}`, 'success');
            } else {
              appendTerminal(`âœ— ${data.message}`, 'error');
            }
          }
          addLog('å‘½ä»¤', `æ‰§è¡Œ: ${command} (è¿”å›ç : ${data.data.return_code || 0})`);
        } else if (data.message) {
          appendTerminal(data.message, data.success ? '' : 'error');
        }
      } catch (error) {
        appendTerminal(`é”™è¯¯: ${error.message}`, 'error');
      }
    }
    
    // åˆ‡æ¢æ™ºèƒ½æ¨¡å¼
    function toggleSmartMode() {
      smartMode = !smartMode;
      const btn = document.getElementById('smartModeBtn');
      if (btn) {
        btn.innerHTML = smartMode 
          ? '<i class="fas fa-brain"></i> æ™ºèƒ½æ¨¡å¼' 
          : '<i class="fas fa-terminal"></i> ç›´æ¥æ¨¡å¼';
        btn.style.background = smartMode 
          ? 'linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)' 
          : 'linear-gradient(135deg, #374151 0%, #1f2937 100%)';
      }
      appendTerminal(smartMode ? 'ğŸ¤– å·²åˆ‡æ¢åˆ°æ™ºèƒ½æ¨¡å¼ (è‡ªç„¶è¯­è¨€ç†è§£)' : 'âš¡ å·²åˆ‡æ¢åˆ°ç›´æ¥æ¨¡å¼ (ç›´æ¥æ‰§è¡Œå‘½ä»¤)', 'info');
    }
    
    function handleCmdKeypress(event) {
      if (event.key === 'Enter') runCommand();
    }
    
    // ========================
    // æ¨¡å‹ç®¡ç†åŠŸèƒ½
    // ========================
    let availableModels = [];
    let currentModelId = null;
    
    // åˆå§‹åŒ–æ—¶åŠ è½½æ¨¡å‹åˆ—è¡¨
    async function loadModels() {
      try {
        const response = await fetch('/api/os/models/os');
        const data = await response.json();
        if (data.success) {
          availableModels = data.data.available_models || [];
          if (data.data.current_model) {
            currentModelId = data.data.current_model.id;
            updateModelButton(data.data.current_model.name);
          }
        }
      } catch (error) {
        console.error('åŠ è½½æ¨¡å‹åˆ—è¡¨å¤±è´¥:', error);
      }
    }
    
    function updateModelButton(modelName) {
      const nameSpan = document.getElementById('currentModelName');
      if (nameSpan) {
        // æ˜¾ç¤ºç®€çŸ­çš„æ¨¡å‹åç§°
        const shortName = modelName.split(' ')[0];
        nameSpan.textContent = shortName.length > 8 ? shortName.substring(0, 8) + '...' : shortName;
      }
    }
    
    // æ˜¾ç¤ºæ¨¡å‹é€‰æ‹©å™¨
    function showModelSelector() {
      // ç§»é™¤å·²æœ‰çš„æ¨¡å‹é€‰æ‹©å¼¹çª—
      const existingPopup = document.getElementById('modelSelectorPopup');
      if (existingPopup) {
        existingPopup.remove();
        return;
      }
      
      const popup = document.createElement('div');
      popup.id = 'modelSelectorPopup';
      popup.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(145deg, #1e293b, #0f172a);
        border: 1px solid rgba(99, 102, 241, 0.3);
        border-radius: 16px;
        padding: 24px;
        min-width: 400px;
        max-width: 500px;
        z-index: 10000;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      `;
      
      let modelsHtml = availableModels.map((model, index) => `
        <div class="model-item" onclick="selectModel('${model.id}', '${model.name}')" 
             style="padding: 12px 16px; margin: 8px 0; border-radius: 10px; cursor: pointer;
                    background: ${model.id === currentModelId ? 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)' : 'rgba(30, 41, 59, 0.8)'};
                    border: 1px solid ${model.id === currentModelId ? '#8b5cf6' : 'rgba(99, 102, 241, 0.2)'};
                    transition: all 0.2s ease;"
             onmouseover="this.style.background='${model.id === currentModelId ? 'linear-gradient(135deg, #7c3aed 0%, #9333ea 100%)' : 'rgba(51, 65, 85, 0.8)'}'"
             onmouseout="this.style.background='${model.id === currentModelId ? 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)' : 'rgba(30, 41, 59, 0.8)'}'"
        >
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div>
              <div style="font-weight: 600; color: #f1f5f9; font-size: 14px;">
                ${model.name}
                ${model.is_free ? '<span style="background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; margin-left: 8px;">å…è´¹</span>' : ''}
                ${!model.available ? '<span style="background: #ef4444; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; margin-left: 8px;">é™æµä¸­</span>' : ''}
              </div>
              <div style="color: #94a3b8; font-size: 12px; margin-top: 4px;">${model.description || ''}</div>
            </div>
            ${model.id === currentModelId ? '<i class="fas fa-check-circle" style="color: #10b981; font-size: 18px;"></i>' : ''}
          </div>
        </div>
      `).join('');
      
      popup.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h3 style="margin: 0; color: #f1f5f9; font-size: 18px;">
            <i class="fas fa-robot" style="color: #8b5cf6; margin-right: 8px;"></i>
            é€‰æ‹© AI æ¨¡å‹
          </h3>
          <button onclick="document.getElementById('modelSelectorPopup').remove()" 
                  style="background: none; border: none; color: #94a3b8; cursor: pointer; font-size: 20px;">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div style="color: #94a3b8; font-size: 13px; margin-bottom: 16px;">
          å½“ä¸€ä¸ªæ¨¡å‹é™æµæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå¯ç”¨æ¨¡å‹
        </div>
        <div style="max-height: 400px; overflow-y: auto;">
          ${modelsHtml || '<div style="color: #94a3b8; text-align: center; padding: 20px;">æš‚æ— å¯ç”¨æ¨¡å‹</div>'}
        </div>
        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(99, 102, 241, 0.2);">
          <button onclick="loadModels(); document.getElementById('modelSelectorPopup').remove(); showModelSelector();" 
                  style="width: 100%; padding: 10px; background: rgba(99, 102, 241, 0.2); border: 1px solid rgba(99, 102, 241, 0.3); 
                         border-radius: 8px; color: #a5b4fc; cursor: pointer; font-size: 13px;">
            <i class="fas fa-sync-alt" style="margin-right: 8px;"></i> åˆ·æ–°æ¨¡å‹çŠ¶æ€
          </button>
        </div>
      `;
      
      // æ·»åŠ é®ç½©å±‚
      const overlay = document.createElement('div');
      overlay.id = 'modelSelectorOverlay';
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9999;
      `;
      overlay.onclick = () => {
        popup.remove();
        overlay.remove();
      };
      
      document.body.appendChild(overlay);
      document.body.appendChild(popup);
    }
    
    // é€‰æ‹©æ¨¡å‹
    async function selectModel(modelId, modelName) {
      try {
        const response = await fetch('/api/os/models/switch', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ agent_type: 'os', model_id: modelId })
        });
        const data = await response.json();
        if (data.success) {
          currentModelId = modelId;
          updateModelButton(modelName);
          appendTerminal(`ğŸ”„ å·²åˆ‡æ¢åˆ°æ¨¡å‹: ${modelName}`, 'info');
        } else {
          appendTerminal(`âŒ åˆ‡æ¢æ¨¡å‹å¤±è´¥: ${data.message}`, 'error');
        }
      } catch (error) {
        appendTerminal(`âŒ åˆ‡æ¢æ¨¡å‹å¤±è´¥: ${error.message}`, 'error');
      }
      
      // å…³é—­å¼¹çª—
      const popup = document.getElementById('modelSelectorPopup');
      const overlay = document.getElementById('modelSelectorOverlay');
      if (popup) popup.remove();
      if (overlay) overlay.remove();
    }
    
    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ¨¡å‹
    document.addEventListener('DOMContentLoaded', () => {
      loadModels();
    });
    
    function focusTerminal() {
      document.getElementById('cmdInput').focus();
    }
    
    function appendTerminal(text, type = '') {
      const output = document.getElementById('terminalOutput');
      
      // å¤„ç†å¤šè¡Œè¾“å‡º - æŒ‰æ¢è¡Œç¬¦åˆ†å‰²
      const lines = text.split('\n');
      
      for (const lineText of lines) {
        if (!lineText.trim() && type !== 'prompt') continue; // è·³è¿‡ç©ºè¡Œï¼ˆä½†ä¿ç•™ promptï¼‰
        
        const line = document.createElement('div');
        line.className = 'line' + (type ? ' ' + type : '');
        
        if (type === 'prompt') {
          line.innerHTML = `<span class="prompt">Î»</span> ${escapeHtml(lineText)}`;
        } else {
          // æ ¼å¼åŒ–è¾“å‡ºï¼šå¤„ç†å¸¸è§çš„ key: value æ ¼å¼
          const formatted = formatOutputLine(lineText);
          line.innerHTML = formatted;
        }
        output.appendChild(line);
      }
      output.scrollTop = output.scrollHeight;
    }
    
    // HTML è½¬ä¹‰
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    // æ ¼å¼åŒ–è¾“å‡ºè¡Œï¼Œç¾åŒ–æ˜¾ç¤º
    function formatOutputLine(line) {
      // å°è¯•åŒ¹é… Key: Value æ ¼å¼
      const keyValueMatch = line.match(/^([^:]+):\s*(.*)$/);
      if (keyValueMatch && keyValueMatch[1].length < 40) {
        const key = escapeHtml(keyValueMatch[1].trim());
        const value = escapeHtml(keyValueMatch[2].trim());
        return `<span style="color: var(--accent-cyan);">${key}:</span> ${value}`;
      }
      return escapeHtml(line);
    }
    
    // æ˜¾ç¤ºç¾åŒ–çš„æ±‡æ€»æ¡†
    function appendSummaryBox(summary) {
      const output = document.getElementById('terminalOutput');
      const box = document.createElement('div');
      box.className = 'summary-box';
      box.style.cssText = `
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
        border: 1px solid rgba(16, 185, 129, 0.3);
        border-radius: 12px;
        padding: 16px 20px;
        margin: 12px 0;
        font-family: var(--font-sans);
      `;
      
      // å¤„ç† Markdown é£æ ¼çš„æ ¼å¼åŒ–
      let formattedSummary = escapeHtml(summary)
        .replace(/\*\*(.+?)\*\*/g, '<strong style="color: var(--accent-green);">$1</strong>')
        .replace(/ğŸ“Š|ğŸ’»|ğŸ§ |ğŸ’¾|ğŸ–¥ï¸|ğŸŒ|ğŸšª|ğŸ“›|â„¹ï¸/g, '<span style="font-size: 1.1em;">$&</span>')
        .split('\n')
        .map(line => line.trim() ? `<div style="margin: 6px 0; line-height: 1.6;">${line}</div>` : '')
        .join('');
      
      box.innerHTML = formattedSummary;
      output.appendChild(box);
      output.scrollTop = output.scrollHeight;
    }
    
    // æ˜¾ç¤ºå¯æŠ˜å çš„è¯¦ç»†è¾“å‡º
    function appendCollapsibleDetails(results) {
      const output = document.getElementById('terminalOutput');
      const detailsId = 'details-' + Date.now();
      
      const container = document.createElement('div');
      container.innerHTML = `
        <div style="margin-top: 8px;">
          <button onclick="toggleDetails('${detailsId}')" style="
            background: rgba(147, 51, 234, 0.2);
            border: 1px solid rgba(147, 51, 234, 0.4);
            color: var(--accent-purple);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            font-family: var(--font-mono);
          ">
            <i class="fas fa-code"></i> æŸ¥çœ‹è¯¦ç»†å‘½ä»¤è¾“å‡º
          </button>
          <div id="${detailsId}" style="display: none; margin-top: 10px; padding: 12px; background: rgba(0,0,0,0.3); border-radius: 8px; font-size: 0.8rem; max-height: 300px; overflow-y: auto;">
            ${results.map(r => `
              <div style="margin-bottom: 12px;">
                <div style="color: var(--accent-cyan); margin-bottom: 4px;">â–¶ ${escapeHtml(r.command)}</div>
                <pre style="white-space: pre-wrap; word-break: break-all; color: var(--text-secondary); margin: 0; font-size: 0.75rem;">${escapeHtml(r.output.substring(0, 1000))}${r.output.length > 1000 ? '...(å·²æˆªæ–­)' : ''}</pre>
              </div>
            `).join('')}
          </div>
        </div>
      `;
      output.appendChild(container);
      output.scrollTop = output.scrollHeight;
    }
    
    // åˆ‡æ¢è¯¦ç»†è¾“å‡ºæ˜¾ç¤º
    function toggleDetails(id) {
      const details = document.getElementById(id);
      if (details) {
        details.style.display = details.style.display === 'none' ? 'block' : 'none';
      }
    }
    
    // Get system info
    async function getSystemInfo() {
      try {
        const response = await fetch(`${API_BASE}/system/info`);
        const data = await response.json();
        
        if (data.success && data.data) {
          const info = data.data;
          let msg = `<b>ç³»ç»Ÿ:</b> ${info.platform.system} ${info.platform.release}
<b>å¤„ç†å™¨:</b> ${info.platform.processor}
<b>CPU:</b> ${info.cpu.cores_logical} æ ¸å¿ƒ, ä½¿ç”¨ç‡ ${info.cpu.usage_percent}%
<b>å†…å­˜:</b> ${info.memory.total_gb}GB æ€»è®¡, ${info.memory.available_gb}GB å¯ç”¨ (${info.memory.used_percent}% ä½¿ç”¨)
<b>ç£ç›˜:</b> ${info.disk.total_gb}GB æ€»è®¡, ${info.disk.free_gb}GB å¯ç”¨ (${info.disk.used_percent}% ä½¿ç”¨)`;
          await neonAlert(msg, 'ç³»ç»Ÿä¿¡æ¯', 'success');
          addLog('ç³»ç»Ÿ', 'è·å–ç³»ç»Ÿä¿¡æ¯');
        } else {
          await neonAlert(data.message, 'è·å–å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`è·å–ç³»ç»Ÿä¿¡æ¯å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // Take screenshot
    async function takeScreenshot() {
      try {
        const response = await fetch(`${API_BASE}/screenshot`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({})
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast(`æˆªå›¾å·²ä¿å­˜: ${data.data.path}`, 'æˆªå±æˆåŠŸ', 'success');
          addLog('æˆªå±', `ä¿å­˜åˆ°: ${data.data.path}`);
        } else {
          await neonAlert(data.message, 'æˆªå±å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`æˆªå±å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // File browser
    async function openFileBrowser() {
      document.getElementById('fileBrowserModal').classList.add('active');
      await loadDirectory('.');
    }
    
    function closeFileBrowser() {
      document.getElementById('fileBrowserModal').classList.remove('active');
    }
    
    async function loadDirectory(path) {
      document.getElementById('currentPath').value = path;
      
      try {
        const response = await fetch(`${API_BASE}/directory/list`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ path: path, include_hidden: false })
        });
        const data = await response.json();
        
        if (data.success && data.data) {
          renderFileList(data.data.items);
        } else {
          await neonAlert(data.message, 'åŠ è½½å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`åŠ è½½ç›®å½•å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    function renderFileList(items) {
      const list = document.getElementById('fileList');
      
      items.sort((a, b) => {
        if (a.is_dir && !b.is_dir) return -1;
        if (!a.is_dir && b.is_dir) return 1;
        return a.name.localeCompare(b.name);
      });
      
      list.innerHTML = items.map(item => `
        <div class="file-item ${item.is_dir ? 'folder' : 'file'}" onclick="handleFileClick('${item.path.replace(/\\/g, '\\\\')}', ${item.is_dir})">
          <i class="fas ${item.is_dir ? 'fa-folder' : 'fa-file'}"></i>
          <span class="name">${item.name}</span>
          <span class="size">${item.is_dir ? '' : formatSize(item.size)}</span>
        </div>
      `).join('');
    }
    
    async function handleFileClick(path, isDir) {
      if (isDir) {
        loadDirectory(path);
      } else {
        const confirmed = await neonConfirm(`ç¡®å®šè¦æ‰“å¼€æ­¤æ–‡ä»¶å—ï¼Ÿ\n\n${path}`, 'æ‰“å¼€æ–‡ä»¶');
        if (confirmed) {
          openFile(path);
        }
      }
    }
    
    async function openFile(path) {
      try {
        const response = await fetch(`${API_BASE}/file/open`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ path: path })
        });
        const data = await response.json();
        
        if (data.success) {
          addLog('æ–‡ä»¶', `æ‰“å¼€: ${path}`);
          neonToast(`å·²æ‰“å¼€: ${path.split(/[/\\]/).pop()}`, 'æ–‡ä»¶å·²æ‰“å¼€', 'success');
        } else {
          await neonAlert(data.message, 'æ‰“å¼€å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`æ‰“å¼€æ–‡ä»¶å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    function navigateToPath() {
      const path = document.getElementById('currentPath').value;
      loadDirectory(path);
    }
    
    async function goUp() {
      const currentPath = document.getElementById('currentPath').value;
      const parts = currentPath.split(/[/\\]/);
      parts.pop();
      const parentPath = parts.join('/') || '.';
      await loadDirectory(parentPath);
    }
    
    function formatSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
    }
    
    // Clipboard
    async function getClipboard() {
      try {
        const response = await fetch(`${API_BASE}/clipboard`);
        const data = await response.json();
        
        if (data.success && data.data) {
          await neonAlert(data.data.content || '(ç©º)', 'å‰ªè´´æ¿å†…å®¹', 'info');
          addLog('å‰ªè´´æ¿', 'è·å–å†…å®¹');
        } else {
          await neonAlert(data.message, 'è·å–å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`è·å–å‰ªè´´æ¿å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    async function promptSetClipboard() {
      const content = await neonPrompt('è¾“å…¥è¦å¤åˆ¶åˆ°å‰ªè´´æ¿çš„å†…å®¹:', '', 'è®¾ç½®å‰ªè´´æ¿', { multiline: true });
      if (content === null) return;
      
      try {
        const response = await fetch(`${API_BASE}/clipboard`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ content: content })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'è®¾ç½®æˆåŠŸ', 'success');
          addLog('å‰ªè´´æ¿', 'è®¾ç½®å†…å®¹');
        } else {
          await neonAlert(data.message, 'è®¾ç½®å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`è®¾ç½®å‰ªè´´æ¿å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // Process list
    async function listProcesses() {
      try {
        const response = await fetch(`${API_BASE}/process/list`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({})
        });
        const data = await response.json();
        
        if (data.success && data.data) {
          const processes = data.data.processes.slice(0, 15);
          let msg = processes.map(p => 
            `<b>${p.name}</b> <span style="color:var(--text-muted)">(PID: ${p.pid})</span> - ${p.memory_percent}%`
          ).join('\n');
          await neonAlert(msg, 'è¿›ç¨‹åˆ—è¡¨ (æŒ‰å†…å­˜æ’åº)', 'info');
          addLog('è¿›ç¨‹', 'è·å–è¿›ç¨‹åˆ—è¡¨');
        } else {
          await neonAlert(data.message, 'è·å–å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`è·å–è¿›ç¨‹å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // Notification
    async function showNotification() {
      const title = await neonPrompt('è¾“å…¥é€šçŸ¥æ ‡é¢˜:', 'JoinFlow é€šçŸ¥', 'å‘é€é€šçŸ¥');
      if (title === null) return;
      const message = await neonPrompt('è¾“å…¥é€šçŸ¥å†…å®¹:', 'è¿™æ˜¯ä¸€æ¡æµ‹è¯•é€šçŸ¥', 'å‘é€é€šçŸ¥');
      if (message === null) return;
      
      try {
        const response = await fetch(`${API_BASE}/notification`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title: title, message: message })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast(`å·²å‘é€: ${title}`, 'é€šçŸ¥å·²å‘é€', 'success');
          addLog('é€šçŸ¥', `å‘é€: ${title}`);
        } else {
          await neonAlert(data.message, 'å‘é€å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`å‘é€é€šçŸ¥å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // Other prompts
    async function promptReadFile() {
      const path = await neonPrompt('è¾“å…¥è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„:', '', 'è¯»å–æ–‡ä»¶', { placeholder: 'C:\\path\\to\\file.txt' });
      if (!path) return;
      
      try {
        const response = await fetch(`${API_BASE}/file/read`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ path: path })
        });
        const data = await response.json();
        
        if (data.success && data.data) {
          console.log(data.data.content);
          const truncated = data.data.content.length > 1500;
          const content = truncated ? data.data.content.substring(0, 1500) + '\n\n... (å†…å®¹è¿‡é•¿å·²æˆªæ–­)' : data.data.content;
          await neonAlert(`<b>å¤§å°:</b> ${data.data.size} å­—èŠ‚\n\n${content}`, 'æ–‡ä»¶å†…å®¹', 'info');
          addLog('æ–‡ä»¶', `è¯»å–: ${path}`);
        } else {
          await neonAlert(data.message, 'è¯»å–å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`è¯»å–æ–‡ä»¶å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    async function promptWriteFile() {
      const path = await neonPrompt('è¾“å…¥è¦å†™å…¥çš„æ–‡ä»¶è·¯å¾„:', '', 'å†™å…¥æ–‡ä»¶', { placeholder: 'C:\\path\\to\\file.txt' });
      if (!path) return;
      const content = await neonPrompt('è¾“å…¥æ–‡ä»¶å†…å®¹:', '', 'å†™å…¥æ–‡ä»¶', { multiline: true });
      if (content === null) return;
      
      try {
        const response = await fetch(`${API_BASE}/file/write`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ path: path, content: content })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast(`æ–‡ä»¶å·²å†™å…¥: ${path.split(/[/\\]/).pop()}`, 'å†™å…¥æˆåŠŸ', 'success');
          addLog('æ–‡ä»¶', `å†™å…¥: ${path}`);
        } else {
          await neonAlert(data.message, 'å†™å…¥å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`å†™å…¥æ–‡ä»¶å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    async function promptOpenApp() {
      const placeholder = currentPlatform === 'Windows' ? 'notepad, calc, chrome' :
                          currentPlatform === 'Darwin' ? 'Safari, TextEdit, Finder' : 'firefox, gedit, nautilus';
      const app = await neonPrompt(`è¾“å…¥è¦æ‰“å¼€çš„åº”ç”¨åç§°:`, '', 'æ‰“å¼€åº”ç”¨', { placeholder });
      if (!app) return;
      
      try {
        const response = await fetch(`${API_BASE}/app/open`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name: app })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast(`å·²å¯åŠ¨: ${app}`, 'åº”ç”¨å·²æ‰“å¼€', 'success');
          addLog('åº”ç”¨', `æ‰“å¼€: ${app}`);
        } else {
          await neonAlert(data.message, 'æ‰“å¼€å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`æ‰“å¼€åº”ç”¨å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    async function promptOpenUrl() {
      const url = await neonPrompt('è¾“å…¥è¦æ‰“å¼€çš„ç½‘å€:', 'https://', 'æ‰“å¼€ URL', { placeholder: 'https://example.com' });
      if (!url) return;
      
      try {
        const response = await fetch(`${API_BASE}/url/open`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ url: url })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast(`å·²æ‰“å¼€: ${url}`, 'URL å·²æ‰“å¼€', 'success');
          addLog('URL', `æ‰“å¼€: ${url}`);
        } else {
          await neonAlert(data.message, 'æ‰“å¼€å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`æ‰“å¼€URLå¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    async function promptTypeText() {
      const text = await neonPrompt('è¾“å…¥è¦æ¨¡æ‹Ÿé”®ç›˜è¾“å…¥çš„æ–‡å­—:', '', 'æ¨¡æ‹Ÿè¾“å…¥', { multiline: true });
      if (!text) return;
      
      try {
        const response = await fetch(`${API_BASE}/keyboard/type`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text: text })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast('æ–‡å­—å·²è¾“å…¥', 'è¾“å…¥æˆåŠŸ', 'success');
          addLog('é”®ç›˜', `è¾“å…¥: ${text.substring(0, 20)}${text.length > 20 ? '...' : ''}`);
        } else {
          await neonAlert(data.message, 'è¾“å…¥å¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`è¾“å…¥å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    async function promptHotkey() {
      const keys = await neonPrompt('è¾“å…¥ç»„åˆé”® (ç”¨é€—å·åˆ†éš”):', '', 'å¿«æ·é”®', { placeholder: 'ctrl,c æˆ– alt,tab æˆ– win,d' });
      if (!keys) return;
      
      const keyList = keys.split(',').map(k => k.trim());
      
      try {
        const response = await fetch(`${API_BASE}/keyboard/hotkey`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ keys: keyList })
        });
        const data = await response.json();
        
        if (data.success) {
          neonToast(`å·²æ‰§è¡Œ: ${keys}`, 'å¿«æ·é”®å·²å‘é€', 'success');
          addLog('é”®ç›˜', `ç»„åˆé”®: ${keys}`);
        } else {
          await neonAlert(data.message, 'æ‰§è¡Œå¤±è´¥', 'error');
        }
      } catch (error) {
        await neonAlert(`ç»„åˆé”®å¤±è´¥: ${error.message}`, 'é”™è¯¯', 'error');
      }
    }
    
    // Logs
    function addLog(action, message, isError = false) {
      const list = document.getElementById('logsList');
      const now = new Date();
      const time = now.toTimeString().split(' ')[0];
      
      const logItem = document.createElement('div');
      logItem.className = 'log-item';
      logItem.innerHTML = `
        <span class="log-time">${time}</span>
        <span class="log-action${isError ? ' error' : ''}">${action}</span>
        <span class="log-message">${message}</span>
      `;
      
      list.insertBefore(logItem, list.firstChild);
      
      while (list.children.length > 50) {
        list.removeChild(list.lastChild);
      }
    }
    
    async function clearLogs() {
      try {
        await fetch(`${API_BASE}/logs`, { method: 'DELETE' });
        document.getElementById('logsList').innerHTML = `
          <div class="log-item">
            <span class="log-time">--:--:--</span>
            <span class="log-action">ç³»ç»Ÿ</span>
            <span class="log-message">æ—¥å¿—å·²æ¸…é™¤</span>
          </div>
        `;
      } catch (error) {
        console.error('Clear logs failed:', error);
      }
    }
    
    // Modal close on background click
    document.getElementById('fileBrowserModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeFileBrowser();
      }
    });
  </script>
</body>
</html>
